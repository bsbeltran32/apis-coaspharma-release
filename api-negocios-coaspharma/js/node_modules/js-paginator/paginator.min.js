/*!
 * PaginatorJS 0.0.3
 * http://mobius.ovh/
 *
 * Released under the MIT license
 */
!function(e){"use strict";window;var t=document,a=t.body,s={limit:0,offset:2,startPage:1,hideDisabled:!0,prevNext:!0,prevText:"&lsaquo;",nextText:"&rsaquo;",firstLast:!1,firstText:"&laquo;",lastText:"&raquo;",ellipsisText:"&hellip;",hashString:"#",classes:{pager:"pg-pager",item:"pg-item",link:"pg-link",prev:"pg-prev",next:"pg-next",first:"pg-first",last:"pg-last",active:"pg-active",disabled:"pg-disabled",ellipsis:"pg-ellipsis"}},n=function(e){return"[object Object]"===Object.prototype.toString.call(e)},i=function(e,t){return e&&e!==a&&(t(e)?e:i(e.parentNode,t))},r=function(e,t){for(var a in t)if(t.hasOwnProperty(a)){var s=t[a];s&&n(s)?(e[a]=e[a]||{},r(e[a],s)):e[a]=s}return e},o=function(e,t,a){var s;if(isNaN(e))if(n(e))for(s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.call(a,e[s],s);else for(s=0;s<e.length;s++)t.call(a,e[s],s);else for(s=0;s<e;s++)t.call(a,s+1,s)},c=function(e,t,a){e.addEventListener(t,a,!1)},l=function(e,a){var s=t.createElement(e);if(a&&"object"==typeof a){var n;for(n in a)"html"===n?s.innerHTML=a[n]:s.setAttribute(n,a[n])}return s},p=function(e){this.config=r(s,e),this.container=this.config.container,"string"==typeof this.container&&(this.container=document.querySelector(this.container)),this.config.pages&&(this.totalPages=this.config.pages),this.limit=this.config.limit,this.offset=this.config.offset,this.hideDisabled=this.config.hideDisabled,this.bindEvents(),this.config.startPage&&this.page(this.config.startPage);var t=this;setTimeout(function(){t.emit("init",t.currentPage)},10)};p.prototype.bindEvents=function(){this.events={click:this.click.bind(this)},c(this.container,"click",this.events.click)},p.prototype.click=function(e){var t=this,a=e.target,s=(t.config,i(a,function(e){return e.item&&!s.ellipsis}));s&&(e.preventDefault(),t.page(parseInt(s.dataset.page,10)))},p.prototype.render=function(e){var t=this,a=t.config,s=document.createDocumentFragment();e&&(t.items=[],t.totalPages=e,t.currentPage>t.totalPages&&(t.currentPage=t.totalPages)),t.pager?t.pager.className=a.classes.pager:t.pager=l("ul",{class:a.classes.pager});var n=t.truncate();return t.hideDisabled&&1===t.currentPage||(a.firstLast&&(t.first=t.renderButton({class:a.classes.first,content:a.firstText,page:1,nav:!0,first:!0}),s.appendChild(t.first)),a.prevNext&&(t.prev=t.renderButton({class:a.classes.prev,content:a.prevText,page:t.currentPage>1?t.currentPage-1:1,nav:!0,prev:!0}),s.appendChild(t.prev))),o(n,function(e,t){s.appendChild(e)}),t.hideDisabled&&t.currentPage===t.totalPages||(a.prevNext&&(t.next=t.renderButton({class:a.classes.next,content:a.nextText,page:t.currentPage<t.totalPages?t.currentPage+1:t.totalPages,nav:!0,next:!0}),s.appendChild(t.next)),a.firstLast&&(t.last=t.renderButton({class:a.classes.last,content:a.lastText,page:t.totalPages,nav:!0,last:!0}),s.appendChild(t.last))),t.pager.innerHTML="",t.pager.appendChild(s),t.container.appendChild(t.pager),t.emit("render"),this},p.prototype.renderButton=function(e){var t=this,a=t.config,s=l("li",{class:a.classes.item});s.dataset.page=e.page,e.page!==t.currentPage||e.ellipsis||e.nav||s.classList.add(a.classes.active);var n=l(e.ellipsis?"span":"a",{class:e.ellipsis?"":a.classes.link,html:e.content});return e.class&&s.classList.add(e.class),e.nav&&(s.nav=!0),e.ellipsis?s.ellipsis=!0:(s.item=!0,n.href=a.hashString.replace("{page}",e.page).replace("{pages}",t.totalPages)),(e.prev||e.first)&&1===t.currentPage||(e.next||e.last)&&t.currentPage===t.totalPages?(s.disabled=!0,s.classList.add(a.classes.disabled),n.tabIndex=-1):s.disabled=!1,s.appendChild(n),s},p.prototype.page=function(e){var t=this,a=t.config;if(a.ajax){a.ajax.data=a.ajax.data||{},a.ajax.data[a.ajax.param||"page"]=e;var s=encodeURIComponent,n=Object.keys(a.ajax.data).map(function(e){s(e),s(a.ajax.data[e])}).join("&"),i=new Request(a.ajax.url+"?"+n,{method:"GET",headers:new Headers});"function"==typeof a.ajax.before&&a.ajax.before.call(t,data),fetch(i).then(function(e){return e.json()}).then(function(s){t.currentPage=e,"function"==typeof a.ajax.success&&a.ajax.success.call(t,s),t.render(),t.emit("change",e)})}else t.currentPage=e,t.render(),t.emit("change",e)},p.prototype.truncate=function(){var e,t=this,a=2*t.offset,s=t.currentPage-t.offset,n=t.currentPage+t.offset,i=[],r=[];if(!t.limit||t.totalPages<=t.limit)o(t.totalPages,function(e){r.push(t.renderButton({page:e,content:e}))});else{t.currentPage<4-t.offset+a?n=3+a:t.currentPage>t.totalPages-(3-t.offset+a)&&(s=t.totalPages-(2+a));for(var c=1;c<=t.totalPages;c++)(1==c||c==t.totalPages||c>=s&&c<=n)&&i.push(c);o(i,function(a){e&&(a-e==2?r.push(t.renderButton({page:e+1,content:e+1})):a-e!=1&&r.push(t.renderButton({class:t.config.classes.ellipsis,content:t.config.ellipsisText,ellipsis:!0}))),r.push(t.renderButton({page:a,content:a})),e=a})}return r},p.prototype.on=function(e,t){this.events[e]=this.events[e]||[],this.events[e].push(t)},p.prototype.off=function(e,t){e in this.events!=!1&&this.events[e].splice(this.events[e].indexOf(t),1)},p.prototype.emit=function(e){if(e in this.events!=!1)for(var t=0;t<this.events[e].length;t++)this.events[e][t].apply(this,[].slice.call(arguments,1))},e.Paginator=p}(this);